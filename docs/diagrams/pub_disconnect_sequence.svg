<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="408px" preserveAspectRatio="none" style="width:732px;height:408px;background:#FFFFFF;" version="1.1" viewBox="0 0 732 408" width="732px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="330" x="202.75" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="320" x="207.75" y="27.9951">Publisher Disconnect Sequence Diagram</text><rect fill="#FFFFFF" height="50.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="39" y="83.5938"/><rect fill="#FFFFFF" height="199.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="132.5" y="162.9922"/><rect fill="#FFFFFF" height="155.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="137.5" y="200.125"/><rect fill="#FFFFFF" height="280.1953" style="stroke:#181818;stroke-width:1.0;" width="10" x="419.5" y="83.5938"/><rect fill="#FFFFFF" height="279.1953" style="stroke:#181818;stroke-width:1.0;" width="10" x="657.5" y="83.5938"/><rect fill="none" height="135.6641" style="stroke:#000000;stroke-width:1.5;" width="653.5" x="73" y="220.125"/><rect fill="none" height="104.5313" style="stroke:#000000;stroke-width:1.5;" width="633.5" x="83" y="244.2578"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="44" x2="44" y1="73.5938" y2="372.7891"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="137" x2="137" y1="73.5938" y2="372.7891"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="424.5" x2="424.5" y1="73.5938" y2="372.7891"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="662.5" x2="662.5" y1="73.5938" y2="372.7891"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="12" y="62.292">Publisher</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="5" y="371.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="12" y="391.7842">Publisher</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89" x="93" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="100" y="62.292">PS_Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89" x="93" y="371.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="100" y="391.7842">PS_Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60" x="394.5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="401.5" y="62.292">Broker</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60" x="394.5" y="371.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="401.5" y="391.7842">Broker</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="618.5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="625.5" y="62.292">Subscriber</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="618.5" y="371.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="625.5" y="391.7842">Subscriber</text><rect fill="#FFFFFF" height="50.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="39" y="83.5938"/><rect fill="#FFFFFF" height="199.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="132.5" y="162.9922"/><rect fill="#FFFFFF" height="155.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="137.5" y="200.125"/><rect fill="#FFFFFF" height="280.1953" style="stroke:#181818;stroke-width:1.0;" width="10" x="419.5" y="83.5938"/><rect fill="#FFFFFF" height="279.1953" style="stroke:#181818;stroke-width:1.0;" width="10" x="657.5" y="83.5938"/><polygon fill="#181818" points="407.5,100.7266,417.5,104.7266,407.5,108.7266,411.5,104.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="49" x2="413.5" y1="104.7266" y2="104.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="56" y="99.6606">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="69" y="99.6606">data</text><polygon fill="#181818" points="645.5,129.8594,655.5,133.8594,645.5,137.8594,649.5,133.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="429.5" x2="651.5" y1="133.8594" y2="133.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="436.5" y="128.7935">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="449.5" y="128.7935">data</text><line style="stroke:#A80036;stroke-width:2.0;" x1="35" x2="53" y1="124.8594" y2="142.8594"/><line style="stroke:#A80036;stroke-width:2.0;" x1="35" x2="53" y1="142.8594" y2="124.8594"/><polygon fill="#181818" points="153.5,158.9922,143.5,162.9922,153.5,166.9922,149.5,162.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="147.5" x2="418.5" y1="162.9922" y2="162.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="159.5" y="157.9263">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="172.5" y="157.9263">LWT on 'publisher/disconnect' with id</text><line style="stroke:#181818;stroke-width:1.0;" x1="142.5" x2="189.5" y1="187.125" y2="187.125"/><line style="stroke:#181818;stroke-width:1.0;" x1="189.5" x2="189.5" y1="187.125" y2="200.125"/><line style="stroke:#181818;stroke-width:1.0;" x1="148.5" x2="189.5" y1="200.125" y2="200.125"/><polygon fill="#181818" points="158.5,196.125,148.5,200.125,158.5,204.125,154.5,200.125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="154.5" y="182.0591">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="167.5" y="182.0591">Get topics by publisher</text><path d="M73,220.125 L150,220.125 L150,227.2578 L140,237.2578 L73,237.2578 L73,220.125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="135.6641" style="stroke:#000000;stroke-width:1.5;" width="653.5" x="73" y="220.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="88" y="233.1919">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99" x="165" y="232.3354">[for each topic]</text><path d="M83,244.2578 L147,244.2578 L147,251.3906 L137,261.3906 L83,261.3906 L83,244.2578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="104.5313" style="stroke:#000000;stroke-width:1.5;" width="633.5" x="83" y="244.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="98" y="257.3247">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="101" x="162" y="256.4683">[topic subs &gt; 0]</text><polygon fill="#181818" points="407.5,278.5234,417.5,282.5234,407.5,286.5234,411.5,282.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="147.5" x2="413.5" y1="282.5234" y2="282.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="154.5" y="277.4575">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="167.5" y="277.4575">publish PubSubAction::DELETE(topic)</text><polygon fill="#181818" points="645.5,307.6563,655.5,311.6563,645.5,315.6563,649.5,311.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="429.5" x2="651.5" y1="311.6563" y2="311.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="436.5" y="306.5903">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="449.5" y="306.5903">TOPIC DELETED on topic</text><line style="stroke:#181818;stroke-width:2.0;" x1="436.5" x2="446.5" y1="335.7891" y2="345.7891"/><line style="stroke:#181818;stroke-width:2.0;" x1="436.5" x2="446.5" y1="345.7891" y2="335.7891"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="441.5" x2="656.5" y1="340.7891" y2="340.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="446.5" y="335.7231">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="459.5" y="335.7231">disconnect/unsubscribe(topic)</text><!--MD5=[b6038f61687dbbe77b9985b34a132186]
@startuml pub disconnect sequence diagram
title Publisher Disconnect Sequence Diagram
autonumber
activate Publisher
participant PS_Service
activate Broker
activate Subscriber

Publisher -> Broker : data
Broker -> Subscriber : data
destroy Publisher
Broker - -> PS_Service : LWT on 'publisher/disconnect' with id
activate PS_Service
PS_Service -> PS_Service : Get topics by publisher
activate PS_Service
loop for each topic
    alt topic subs > 0
        PS_Service -> Broker : publish PubSubAction::DELETE(topic)
        Broker -> Subscriber : TOPIC DELETED on topic
        Subscriber - ->x Broker : disconnect/unsubscribe(topic)
    end
    deactivate PS_Service
end
deactivate PS_Service
deactivate Subscriber
@enduml

PlantUML version 1.2022.7(Mon Aug 22 10:01:30 PDT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>